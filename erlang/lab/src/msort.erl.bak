-module(msort).
-export([splitmerge/0]).
-export([sorter/0]).
-export([send/2]).


splitmerge() ->
  receive
    {Pid,List} -> 
      Sorter1 = spawn(fun sorter/0),
      Sorter2 = spawn(fun sorter/0),
      {List1,List2} = lists:split(length(List) div 2,List),
      Sorter1 ! {self(),List1},
      Sorter2 ! {self(),List2}
  end,
  receive
    {Sorter1,SList1} -> ok
  end,
  receive
    {Sorter2,SList2} -> ok
  end,
  Pid ! lists:merge(SList1,SList2).


sorter() -> 
  receive
    {Pidsm,Listsm} -> 
      Pidsm ! {self(),lists:sort(Listsm)}
  end.


send(To,Message) ->
  To ! {self(),Message},
  receive
    Y -> 
      lists:foreach(fun(X) -> io:format("~p ", [X]) end,Y),
      io:format("~n")
  end.
